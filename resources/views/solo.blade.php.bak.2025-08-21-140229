@extends('layouts.app')

@section('content')
<style>
  *, *::before, *::after { box-sizing: border-box; }
  body{ background:#003DA5; color:#fff;  overflow-x:hidden; }
  .container-solo{ max-width:980px; margin:40px auto;  padding:0 16px; overflow:hidden; }
  .grid-2{ display:grid; grid-template-columns: repeat(auto-fit, minmax(220px,1fr)); gap:12px; }
  .btn-theme{ display:block; width:100%; padding:14px 16px; border-radius:10px; background:#1E90FF; color:#fff; border:0; cursor:pointer;  white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
  .btn-theme:disabled{ opacity:.4; cursor:not-allowed; }
  .box{ background:rgba(0,0,0,.15); padding:18px; border-radius:12px; margin-bottom:16px; }
  .lbl{ font-weight:600; margin-right:8px; }
  select, .form-select{ color:#000; }
</style>

<div class="container-solo">
  <h1 class="display-4 text-center">Mode Solo</h1>
  <p class="lead text-center" style="margin-top:6px">Votre Niveau : <strong>{{ $choix_niveau }}</strong></p>

  <form id="soloForm" action="{{ route('solo.start') }}" method="POST">
    @csrf

    <div class="box text-center">
      <div class="mb-2"><strong>Choisissez vos options puis un thÃ¨me pour commencer la partie :</strong></div>

      <div class="mb-2">
        <span class="lbl">Nombre de questions :</span>
        <select name="nb_questions" id="nb_questions" class="form-select d-inline-block" style="width:auto;">
          <option value="">-- Choisissez --</option>
          <option value="10"  {{ (isset($nb_questions) && $nb_questions==10)  ? 'selected' : '' }}>10</option>
          <option value="20"  {{ (isset($nb_questions) && $nb_questions==20)  ? 'selected' : '' }}>20</option>
          <option value="30"  {{ (isset($nb_questions) && $nb_questions==30)  ? 'selected' : '' }}>30</option>
          <option value="40"  {{ (isset($nb_questions) && $nb_questions==40)  ? 'selected' : '' }}>40</option>
          <option value="50"  {{ (isset($nb_questions) && $nb_questions==50)  ? 'selected' : '' }}>50</option>
        </select>
      </div>

      <div class="mb-2">
        <span class="lbl">Niveau :</span>
        <select name="niveau_joueur" id="niveau_joueur" class="form-select d-inline-block" style="width:auto;">
          @for ($i=1; $i<=100; $i++)
            <option value="{{ $i }}"
              {{ $i == ($niveau_selectionne ?? $choix_niveau) ? 'selected' : '' }}
              {{ $i > $choix_niveau ? 'disabled' : '' }}>
              Niveau {{ $i }}{{ $i > $choix_niveau ? ' ğŸ”’' : '' }}
            </option>
          @endfor
        </select>
      </div>

      <div class="mb-1">
        <span class="lbl">Choix de lâ€™Avatar StratÃ©gique (optionnel) :</span>
        <span>{{ $avatar_stratÃ©gique ?? 'Aucun' }}</span>
        <a href="{{ \Illuminate\Support\Facades\Route::has('avatar') ? route('avatar') : url('/avatar') }}"
           class="btn btn-sm btn-outline-light ms-2">SÃ©lectionner</a>
      </div>
    </div>

    <div class="grid-2">
      <button type="submit" class="btn-theme" name="theme" value="general">ğŸ§  GÃ©nÃ©ral</button>
      <button type="submit" class="btn-theme" name="theme" value="geographie">ğŸŒ GÃ©ographie</button>
      <button type="submit" class="btn-theme" name="theme" value="histoire">ğŸ“œ Histoire</button>
      <button type="submit" class="btn-theme" name="theme" value="art">ğŸ¨ Art</button>
      <button type="submit" class="btn-theme" name="theme" value="cinema">ğŸ¬ CinÃ©ma</button>
      <button type="submit" class="btn-theme" name="theme" value="sport">ğŸ… Sport</button>
      <button type="submit" class="btn-theme" name="theme" value="faune">ğŸ¦ Faune</button>
      <button type="submit" class="btn-theme" name="theme" value="cuisine">ğŸ³ Cuisine</button>
    </div>
  </form>
</div>

<script>
  // Avatar est optionnel â†’ on ne vÃ©rifie que nb_questions et que le niveau sÃ©lectionnÃ© est valide
  const form = document.getElementById('soloForm');
  document.querySelectorAll('.btn-theme').forEach(btn => {
    btn.addEventListener('click', (e) => {
      const nbq = document.getElementById('nb_questions').value;
      const niv = document.getElementById('niveau_joueur');
      if (!nbq) {
        e.preventDefault();
        alert('Choisissez le nombre de questions.');
        return false;
      }
      // Si lâ€™option niveau sÃ©lectionnÃ©e est disabled (devrait pas arriver), on bloque
      if (niv.selectedOptions.length && niv.selectedOptions[0].disabled) {
        e.preventDefault();
        alert('Ce niveau est verrouillÃ©.');
        return false;
      }
    });
  });
</script>
@endsection
